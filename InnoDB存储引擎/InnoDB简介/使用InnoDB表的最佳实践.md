# 14.1.2 使用InnoDB表的最佳实践

本节介绍使用InnoDB表时的最佳实践。
* 使用查询频率最高的一列或者多列作为指定每一张表的主键，如果没有明显的主键，则指定`自动增量（auto-increment）`值。

* 根据来自这些表的相同ID值从多个表中提取数据的位置使用joins。
当需要从多个表中提取数据时，根据来自这些表的相同的ID值使用`joins`完成。要获得快速连接性能，请在连接列上定义外键，并在每个表中声明具有相同数据类型的列。添加外键可确保对引用的列建立索引，从而提高性能。外键还会将删除或更新传播到所有受影响的表，如果父表中不存在相应的ID，则会阻止在子表中插入数据。

* 关闭`自动提交(autocommit)`。每秒提交数百次会限制性能（受存储设备写入速度的限制）。

* 将相关DML操作集合分成多个组，每个组用最前和最后分别加上START TRANSACTION 和 COMMIT语句。因为，既然您不想提交的次数太多，那么，您肯定也不想将运行多个小时的产生的插入，删除或者更新语句放到一个事务中提交。

* 不要使用 LOCK TABLES 语句。InnoDB可以同时处理多个会话，同时读取和写入同一个表，而不会牺牲可靠性或高性能。要获得对一组行的独占写访问权，请使用SELECT ... FOR UPDATE语法仅锁定要更新的行。

* 启用`innodb_file_per_table`选项可将各个表的数据和索引放入单独的文件中，而不是`系统表空间`。有些功能需要启用此设置才能使用，例如表`压缩`。该选项是默认启用的。

* 评估您的数据和访问模式是否受益于InnoDB表压缩功能。您可以在不牺牲读/写功能的情况下压缩InnoDB表。

* 如果`CREATE TABLE`的`ENGINE =`子句中指定的引擎存在问题，使用选项`--sql_mode = NO_ENGINE_SUBSTITUTION`运行服务器以防止使用其他存储引擎创建表。

